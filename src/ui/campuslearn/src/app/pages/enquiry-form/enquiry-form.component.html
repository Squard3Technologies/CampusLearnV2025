<div class="enquiry-form-container">
  <div class="page-header">
    <h1>Ask a Question</h1>
    <p>Submit your question to get help from tutors</p>
  </div>

  <!-- Success Message -->
  <div class="success-message" *ngIf="formSubmitted">
    <h3>Question Submitted Successfully!</h3>
    <p>Your enquiry has been received. A tutor will respond to your question soon.</p>
    <div class="actions">
      <a [routerLink]="['/home']">Return to Home</a> |
      <a [routerLink]="['/modules']">Browse Modules</a>
    </div>
  </div>

  <!-- Error Message -->
  <div class="error-alert" *ngIf="submitError">
    <h3>Submission Error</h3>
    <p>There was a problem submitting your question. Please try again later.</p>
  </div>

  <!-- Loading spinner -->
  <div class="loading-spinner" *ngIf="isLoading">
    <div class="spinner"></div>
  </div>

  <!-- Enquiry Form -->
  <div class="form-card" *ngIf="!isLoading && !formSubmitted">
    <form [formGroup]="enquiryForm" (ngSubmit)="submitEnquiry()">
      <div class="form-group">
        <label for="moduleId">Select Module</label>
        <select
          id="moduleId"
          formControlName="moduleId"
          class="form-control">
          <option value="">-- Select a module --</option>
          <option *ngFor="let module of modules" [value]="module.id">
            {{ module.code }}: {{ module.name }}
          </option>
        </select>
        <div
          class="error-message"
          *ngIf="enquiryForm.get('moduleId')?.invalid && enquiryForm.get('moduleId')?.touched">
          Please select a module.
        </div>
      </div>

      <div class="form-group">
        <label for="title">Question Title</label>
        <input
          type="text"
          id="title"
          formControlName="title"
          class="form-control"
          placeholder="Enter a concise title for your question">
        <div
          class="error-message"
          *ngIf="enquiryForm.get('title')?.invalid && enquiryForm.get('title')?.touched">
          Please enter a title between 5 and 100 characters.
        </div>
      </div>

      <div class="form-group">
        <label for="content">Question Details</label>
        <textarea
          id="content"
          formControlName="content"
          class="form-control"
          placeholder="Describe your question in detail..."></textarea>
        <div
          class="error-message"
          *ngIf="enquiryForm.get('content')?.invalid && enquiryForm.get('content')?.touched">
          Please provide more details (minimum 20 characters).
        </div>
      </div>

      <div class="form-actions">
        <button
          type="button"
          class="btn btn-cancel"
          [routerLink]="['/home']">
          Cancel
        </button>
        <button
          type="submit"
          class="btn btn-submit"
          [disabled]="enquiryForm.invalid || !currentUserId">
          Submit Question
        </button>
      </div>
    </form>
  </div>
</div>
