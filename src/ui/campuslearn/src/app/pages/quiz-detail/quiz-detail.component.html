<div class="quiz-detail-container">
  <!-- Loading spinner -->
  <div class="loading-spinner" *ngIf="isLoading">
    <div class="spinner"></div>
  </div>

  <div *ngIf="!isLoading && quiz">
    <!-- Quiz Header -->
    <div class="quiz-header">
      <h1>{{ quiz.title }}</h1>
      <div class="quiz-meta">
        <span>Created: {{ quiz.dateCreated | date:'mediumDate' }}</span>
        <span class="quiz-duration">Duration: {{ quiz.duration }}</span>
      </div>

      <div class="quiz-actions" *ngIf="!quizStarted && !quizCompleted">
        <button class="btn-start" (click)="startQuiz()">Start Quiz</button>
        <button class="btn-back" [routerLink]="['/topics', quiz.topicId]">Back to Topic</button>
      </div>
    </div>

    <!-- Quiz Form (Questions) -->
    <div class="quiz-form" *ngIf="quizStarted && !quizCompleted">
      <div class="intro-message">
        <h2>Quiz in Progress</h2>
        <p>Answer all questions and click Submit when you're done. Good luck!</p>
      </div>

      <form [formGroup]="quizForm" (ngSubmit)="submitQuiz()">
        <div class="questions-list">
          <div class="question-card" *ngFor="let qwo of questionsWithOptions; let i = index">
            <div class="question-number">Question {{ i + 1 }}</div>
            <div class="question-content">
              <!-- Mock question text since our model doesn't include the text -->
              What is the answer to this {{ qwo.question.questionType === 1 ? 'true/false' : 'multiple choice' }} question?
            </div>

            <div class="options-list">
              <div class="option-item" *ngFor="let option of qwo.options">
                <label>
                  <input
                    type="radio"
                    [name]="qwo.question.id"
                    [value]="option.id"
                    [formControlName]="qwo.question.id">
                  {{ option.value }}
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button
            type="submit"
            class="btn-submit"
            [disabled]="quizForm.invalid">
            Submit Quiz
          </button>
        </div>
      </form>
    </div>

    <!-- Quiz Results -->
    <div class="quiz-results" *ngIf="quizCompleted">
      <div class="score-display">{{ quizScore }}%</div>
      <h2>Quiz Completed!</h2>

      <p *ngIf="quizScore && quizScore >= 70">
        Congratulations! You've passed the quiz.
      </p>

      <p *ngIf="quizScore && quizScore < 70">
        You didn't pass this time. Consider reviewing the material and trying again.
      </p>

      <div class="results-actions">
        <a class="btn btn-primary" [routerLink]="['/topics', quiz.topicId]">
          Back to Topic
        </a>
        <a class="btn btn-secondary" [routerLink]="['/modules']">
          All Modules
        </a>
      </div>
    </div>
  </div>
</div>
